extends layout

block content
    h1 Import Households

    // Form to upload file and handle mapping
    form#import-form(method='POST', enctype='multipart/form-data', action='/api/households/import/mapped')
        div.form-group
            label(for='fileUpload') Upload Excel File
            input#fileUpload.form-control(type='file', name='fileUpload', accept='.xlsx, .xls')

        // Mapping can be handled via frontend, such as dynamically generating mapping fields
        // For simplicity, assuming mapping is handled via frontend JS

        button.btn.btn-primary(type='submit') Start Import

    // Include the Progress Container Partial
    include partials/progressContainer.pug

    // Import History Section
    section#import-history.mt-5
        h3 Import History
        table.table.table-striped
            thead
                tr
                    th Import Type
                    th Import Date
                    th Actions
            tbody
                if importReports.length > 0
                    each report in importReports
                        tr
                            td #{report.importType}
                            td #{formatDate(report.createdAt)}
                            td
                                button.btn.btn-secondary.get-history-report-button(data-report-id=report._id) Get Report
                else
                    tr
                        td(colspan='3') No import history available.

block scripts

    script(src='/socket.io/socket.io.js') 
    script(src='https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js', integrity='sha384-geWF76RCwLtnZ8qwWowPQNguL3RmwHVBC9FhGdlKrxdiJJigb/j/68SIy3Te4Bkz', crossorigin='anonymous')
    script(src='/js/appScript.js')
    script(src="/js/importHistoryManager.js")
